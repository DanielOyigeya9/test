<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DUB - Premium Bandwidth Sharing</title>
    <script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #00ffaa;
            --secondary: #0088ff;
            --dark: #0f172a;
            --glass: rgba(255, 255, 255, 0.05);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0f172a, #1e293b);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
        }

        /* Header with new logo - Modified to shift logo right */
        header {
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            background-size: 200% auto;
            animation: gradient 3s linear infinite;
            padding: 1rem 1.5rem;
            text-align: left;
            display: flex;
            align-items: center;
            gap: 1rem;
            position: relative;
            padding-left: 2.5rem;
            justify-content: space-between;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-right: 3.5rem;
            position: relative;
        }

        .beta-badge {
            position: absolute;
            bottom: -15px;
            left: 50px;
            background: var(--primary);
            color: var(--dark);
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: bold;
            transform: translateX(-50%);
        }

        .logo-svg {
            width: 40px;
            height: 40px;
        }

        .logo-text {
            font-weight: bold;
            font-size: 1.8rem;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-right: 0.5rem;
        }

        @keyframes gradient {
            0% { background-position: 0% center; }
            100% { background-position: 200% center; }
        }

        /* Glassmorphism Panel */
        .glass-card {
            background: var(--glass);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            margin-bottom: 1.5rem;
        }

        /* Mining Button */
        .mine-btn {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            border: none;
            padding: 1rem 2rem;
            font-size: 1.2rem;
            border-radius: 50px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 0 15px rgba(0, 255, 170, 0.5);
            position: relative;
            overflow: hidden;
            width: 100%;
        }

        .mine-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 0 25px rgba(0, 255, 170, 0.8);
        }

        .mine-btn.active {
            animation: pulse 1.5s infinite;
        }

        .mine-btn.connecting {
            background: linear-gradient(45deg, #ff9900, #ff6600);
            animation: connectingPulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(0, 255, 170, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(0, 255, 170, 0); }
            100% { box-shadow: 0 0 0 0 rgba(0, 255, 170, 0); }
        }

        @keyframes connectingPulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 153, 0, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(255, 153, 0, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 153, 0, 0); }
        }

        /* Updated Earnings Graph Styles - COMPLETELY REDESIGNED */
        .graph-container {
            height: 300px;
            margin: 1rem 0;
            position: relative;
            width: 100%;
        }

        .graph-content {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .graph-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .graph-date {
            font-size: 0.9rem;
            color: var(--primary);
        }

        .graph-svg {
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            overflow: visible;
        }

        .graph-bar {
            fill: var(--primary);
            transition: all 0.3s;
        }

        .graph-bar:hover {
            opacity: 0.8;
        }

        .graph-x-axis {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.7);
        }

        /* Earnings Display */
        #earningsDisplay {
            font-size: 2rem;
            font-weight: bold;
            text-align: center;
            margin: 1rem 0;
            color: var(--primary);
        }

        /* Goal System Styles */
        .goal-container {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .goal-input {
            padding: 0.5rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            color: white;
            width: 100px;
        }

        .goal-btn {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            color: white;
            cursor: pointer;
        }

        .goal-progress {
            margin-left: auto;
            font-size: 0.9rem;
            color: var(--primary);
        }

        .goal-reached {
            animation: celebrate 2s infinite;
            text-align: center;
            margin-top: 1rem;
            font-weight: bold;
            font-size: 1.2rem;
            color: var(--primary);
            display: none;
        }

        @keyframes celebrate {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* Dashboard Layout */
        .dashboard {
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
            flex: 1;
        }

        /* Referral button styling */
        .referral-code {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .referral-code input {
            flex: 1;
            padding: 0.75rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50px;
            color: white;
            text-align: center;
        }

        .referral-code button {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            border: none;
            padding: 0 1.5rem;
            border-radius: 50px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 0 10px rgba(0, 255, 170, 0.3);
        }

        .referral-code button:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 15px rgba(0, 255, 170, 0.5);
        }

        /* Data Collection Section */
        .data-collection {
            margin-top: 1rem;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
        }

        /* Admin Panel (hidden by default) */
        .admin-panel {
            display: none;
            margin-top: 2rem;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            border: 1px solid var(--primary);
        }

        .admin-btn {
            background: var(--primary);
            color: var(--dark);
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 0.5rem;
        }

        /* Logo Link */
        .logo-link {
            color: inherit;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        /* Rewards Page Styles */
        .task-card {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            margin-bottom: 1rem;
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.2);
        }

        .task-info {
            flex: 1;
        }

        .task-reward {
            color: var(--primary);
            font-weight: bold;
        }

        .task-btn {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 50px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
        }

        .task-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 255, 170, 0.4);
        }

        /* Verification Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background: var(--dark);
            padding: 2rem;
            border-radius: 16px;
            width: 90%;
            max-width: 400px;
            border: 1px solid var(--primary);
        }

        .modal-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 1.5rem;
        }

        .modal-btn {
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .modal-btn.cancel {
            background: transparent;
            border: 1px solid #ff5555;
            color: #ff5555;
        }

        .modal-btn.submit {
            background: var(--primary);
            border: 1px solid var(--primary);
            color: var(--dark);
        }

        .modal-btn:hover {
            opacity: 0.8;
        }

        .modal-input {
            width: 100%;
            padding: 0.75rem;
            margin-top: 1rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            color: white;
        }

        /* Boost Cards */
        .boost-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .boost-card {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .boost-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            border-color: var(--primary);
        }

        .boost-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: var(--primary);
        }

        .boost-multiplier {
            background: rgba(0, 255, 170, 0.2);
            padding: 0.25rem 0.75rem;
            border-radius: 50px;
            font-size: 0.9rem;
            margin: 0.5rem auto;
            display: inline-block;
        }

        .boost-btn {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 50px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 1rem;
            width: 100%;
            pointer-events: none;
            opacity: 0.7;
        }

        .boost-btn:hover {
            transform: none;
            box-shadow: none;
        }

        .coming-soon {
            position: relative;
        }

        .coming-soon::after {
            content: "COMING SOON";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.8);
            color: var(--primary);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .stat-card {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary);
            margin: 0.5rem 0;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        /* App Connect Modal */
        .app-connect-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .app-connect-content {
            background: var(--dark);
            padding: 2rem;
            border-radius: 16px;
            width: 90%;
            max-width: 400px;
            border: 1px solid var(--primary);
            text-align: center;
        }

        .app-connect-icon {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 1rem;
        }

        /* Login/Signup Modal */
        .auth-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .auth-content {
            background: var(--dark);
            padding: 2rem;
            border-radius: 16px;
            width: 90%;
            max-width: 400px;
            border: 1px solid var(--primary);
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .auth-tab {
            padding: 0.5rem 1rem;
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }

        .auth-tab.active {
            border-bottom: 2px solid var(--primary);
            color: var(--primary);
        }

        .auth-form {
            display: none;
        }

        .auth-form.active {
            display: block;
        }

        .auth-input {
            width: 100%;
            padding: 0.75rem;
            margin: 0.75rem 0;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            color: white;
        }

        .auth-btn {
            width: 100%;
            padding: 0.75rem;
            margin: 1rem 0;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            border: none;
            border-radius: 4px;
            color: white;
            cursor: pointer;
            font-weight: bold;
        }

        .auth-error {
            color: #ff5555;
            font-size: 0.9rem;
            margin-top: 0.5rem;
            display: none;
        }

        /* User Profile Section */
        .user-profile {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .user-name {
            font-weight: bold;
        }

        .logout-btn {
            background: transparent;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 0.9rem;
            opacity: 0.7;
        }

        .logout-btn:hover {
            opacity: 1;
        }

        /* Admin Dashboard Styles */
        .admin-dashboard {
            display: none;
        }

        .admin-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        .admin-table th, .admin-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .admin-table th {
            background: rgba(0, 0, 0, 0.3);
            color: var(--primary);
        }

        .admin-table tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        /* Responsive adjustments */
        @media (max-width: 767px) {
            header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
                padding-left: 1.5rem;
            }
            .logo-container {
                margin-left: 0;
            }
            .dashboard {
                margin-bottom: 0;
                padding: 1rem;
            }
            .goal-container {
                flex-wrap: wrap;
            }
            .goal-progress {
                margin-left: 0;
                width: 100%;
                text-align: center;
            }
            .beta-badge {
                left: 40px;
                bottom: -12px;
                font-size: 0.6rem;
            }
            .admin-table {
                display: block;
                overflow-x: auto;
            }
        }
    </style>
</head>
<body>
    <!-- Auth Modal (shown by default) -->
    <div id="authModal" class="auth-modal">
        <div class="auth-content">
            <div class="auth-tabs">
                <div class="auth-tab active" id="loginTab">Login</div>
                <div class="auth-tab" id="signupTab">Sign Up</div>
            </div>
            
            <div class="auth-form active" id="loginForm">
                <input type="email" id="loginEmail" class="auth-input" placeholder="Email">
                <input type="password" id="loginPassword" class="auth-input" placeholder="Password">
                <div class="auth-error" id="loginError">Invalid email or password</div>
                <button class="auth-btn" id="loginBtn">Login</button>
                <div style="text-align: center; margin-top: 1rem; font-size: 0.9rem;">
                    <a href="#" id="forgotPassword" style="color: var(--primary);">Forgot password?</a>
                </div>
            </div>
            
            <div class="auth-form" id="signupForm">
                <input type="text" id="signupName" class="auth-input" placeholder="Full Name">
                <input type="email" id="signupEmail" class="auth-input" placeholder="Email">
                <input type="password" id="signupPassword" class="auth-input" placeholder="Password">
                <input type="password" id="signupConfirmPassword" class="auth-input" placeholder="Confirm Password">
                <div class="auth-error" id="signupError">Passwords don't match</div>
                <button class="auth-btn" id="signupBtn">Sign Up</button>
            </div>
        </div>
    </div>

    <!-- Main App Content (hidden until authenticated) -->
    <div id="appContent" style="display: none;">
        <header>
            <a href="#" class="logo-link">
                <div class="logo-container">
                    <svg class="logo-svg" viewBox="0 0 100 100">
                        <defs>
                            <linearGradient id="logoGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#00ffaa" />
                                <stop offset="100%" stop-color="#0088ff" />
                            </linearGradient>
                        </defs>
                        <rect x="10" y="10" width="80" height="80" rx="15" fill="url(#logoGradient)" />
                        <path d="M30,30 L70,30 L70,50 L50,50 L50,70 L30,70 Z" fill="white" />
                    </svg>
                    <div class="logo-text">DUB</div>
                    <div class="beta-badge">BETA</div>
                </div>
                <p>Earn $DUB by sharing your unused bandwidth</p>
            </a>
            
            <div class="user-profile">
                <div class="user-avatar" id="userAvatar">U</div>
                <div>
                    <div class="user-name" id="userName">User</div>
                    <button class="logout-btn" id="logoutBtn">Logout</button>
                </div>
            </div>
        </header>

        <!-- Dashboard Page Content -->
        <main class="dashboard">
            <div class="glass-card">
                <h2><i class="fas fa-chart-line"></i> Earnings Dashboard SEASON 0!</h2>
                
                <!-- Goal System -->
                <div class="goal-container">
                    <span>Today's Goal:</span>
                    <input type="number" id="dailyGoal" class="goal-input" placeholder="1000" min="1">
                    <button id="setGoalBtn" class="goal-btn">Set Goal</button>
                    <div class="goal-progress" id="goalProgress">0/0 DUB</div>
                </div>
                <div class="goal-reached" id="goalReached">ðŸŽ‰ Goal Reached! Great Job! ðŸŽ‰</div>
                
                <!-- Earnings Display moved outside the graph -->
                <div id="earningsDisplay"><B>0.00 <br> $DUB</B></div>
                
                <div class="graph-container">
                    <div class="graph-content">
                        <div class="graph-header">
                            <div>Daily Earnings</div>
                            <div class="graph-date" id="currentDate"></div>
                        </div>
                        <svg class="graph-svg" viewBox="0 0 500 250" preserveAspectRatio="none" id="graphSvg">
                            <!-- Horizontal baseline -->
                            <line x1="0" y1="250" x2="500" y2="250" stroke="rgba(255,255,255,0.2)" stroke-width="1" />
                            <!-- Bars will be generated by JavaScript -->
                        </svg>
                        <div class="graph-x-axis" id="xAxisDates">
                            <!-- Dates will be generated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>

            <div class="glass-card">
                <h2><i class="fas fa-network-wired"></i> Mining Control</h2>
                <button id="mineBtn" class="mine-btn">
                    <i class="fas fa-power-off"></i> CONNECT
                </button>
                <div id="miningStatus" style="margin-top: 1rem;">
                    <i class="fas fa-circle" style="color: #ff5555;"></i> Status: OFFLINE
                </div>
                <div id="connectionStatus" style="margin-top: 0.5rem; font-size: 0.9rem; color: rgba(255,255,255,0.7);"></div>
                
                <!-- Bandwidth Data Collection Section -->
                <div class="data-collection">
                    <p>Bandwidth sharing data is being collected and sent to our servers while connected</p>
                </div>
            </div>

            <!-- Hidden Admin Panel (for demonstration) -->
            <div id="adminPanel" class="admin-panel">
                <h3><i class="fas fa-lock"></i> Admin Panel</h3>
                <p>Total bandwidth shared by all users: <span id="totalBandwidth">0</span> MB</p>
                <p>Active sessions: <span id="activeSessions">0</span></p>
                <button id="exportDataBtn" class="admin-btn">
                    <i class="fas fa-file-excel"></i> Export All Data to Excel
                </button>
            </div>

            <div class="glass-card">
                <h2><i class="fas fa-user-friends"></i> Referral Program</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Total Referrals</div>
                        <div class="stat-value" id="totalReferrals">0</div>
                        <div class="stat-label">Active Today</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Referral Earnings</div>
                        <div class="stat-value" id="referralEarnings">0.00</div>
                        <div class="stat-label">$DUB</div>
                    </div>
                </div>
                <p>Earn 10% of your friend's mining rewards!</p>
                <div class="referral-code">
                    <input type="text" id="refCode" value="DUB-XXXX-XXXX" readonly>
                    <button onclick="copyReferral()">
                        <i class="fas fa-copy"></i> Copy
                    </button>
                </div>
            </div>

            <div class="glass-card">
                <h2><i class="fas fa-bolt"></i> Boost Your Mining</h2>
                <p>Increase your mining speed with these boosts:</p>
                
                <div class="boost-container">
                    <div class="boost-card">
                        <div class="boost-icon"><i class="fab fa-chrome"></i></div>
                        <h3>Browser Extension</h3>
                        <div class="boost-multiplier">3x Mining Speed</div>
                        <p>Install our Chrome extension to mine while you browse</p>
                        <button class="boost-btn coming-soon" id="extensionBtn">
                            <i class="fas fa-download"></i> Download
                        </button>
                    </div>
                    
                    <div class="boost-card">
                        <div class="boost-icon"><i class="fab fa-telegram"></i></div>
                        <h3>Telegram Bot</h3>
                        <div class="boost-multiplier">1.5x Mining Speed</div>
                        <p>Join our Telegram bot to earn extra rewards</p>
                        <button class="boost-btn coming-soon" id="telegramBtn">
                            <i class="fab fa-telegram"></i> Join
                        </button>
                    </div>
                    
                    <div class="boost-card">
                        <div class="boost-icon"><i class="fas fa-desktop"></i></div>
                        <h3>Desktop App</h3>
                        <div class="boost-multiplier">5x Mining Speed</div>
                        <p>Maximize earnings with our desktop application</p>
                        <button class="boost-btn coming-soon" id="desktopBtn">
                            <i class="fas fa-download"></i> Download
                        </button>
                    </div>
                </div>
            </div>

            <div class="glass-card">
                <h2><i class="fas fa-tasks"></i> Available Tasks</h2>
                
                <div class="task-card">
                    <div class="task-info">
                        <h3>Follow @DUBCOIN9 on Twitter</h3>
                        <p>Follow our official Twitter account for updates and rewards</p>
                    </div>
                    <div class="task-reward">+3000 DUB</div>
                    <button class="task-btn" id="twitterTaskBtn">Claim</button>
                </div>
                
                <div class="task-card">
                    <div class="task-info">
                        <h3>Join Telegram Channel</h3>
                        <p>Join our official Telegram channel for updates</p>
                    </div>
                    <div class="task-reward">+2000 DUB</div>
                    <button class="task-btn" id="telegramTaskBtn">Claim</button>
                </div>
            </div>
        </main>

        <!-- Admin Dashboard (hidden by default) -->
        <div id="adminDashboard" class="admin-dashboard">
            <div class="glass-card">
                <h2><i class="fas fa-tachometer-alt"></i> Admin Dashboard</h2>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Total Users</div>
                        <div class="stat-value" id="adminTotalUsers">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Active Today</div>
                        <div class="stat-value" id="adminActiveUsers">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Total Bandwidth</div>
                        <div class="stat-value" id="adminTotalBandwidth">0</div>
                        <div class="stat-label">GB</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Total Earnings</div>
                        <div class="stat-value" id="adminTotalEarnings">0</div>
                        <div class="stat-label">DUB</div>
                    </div>
                </div>
                
                <h3 style="margin-top: 2rem;"><i class="fas fa-users"></i> User Activity</h3>
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Bandwidth</th>
                            <th>Earnings</th>
                            <th>Last Active</th>
                        </tr>
                    </thead>
                    <tbody id="adminUserTable">
                        <!-- User data will be populated here -->
                    </tbody>
                </table>
                
                <div style="margin-top: 1.5rem;">
                    <button id="adminExportBtn" class="admin-btn">
                        <i class="fas fa-file-excel"></i> Export All User Data
                    </button>
                </div>
            </div>
        </div>

        <!-- Verification Modal (hidden by default) -->
        <div id="verificationModal" class="modal-overlay" style="display: none;">
            <div class="modal-content">
                <h3>Twitter Follow Verification</h3>
                <p>Please enter the verification code from our Twitter page (@DUBCOIN9) to confirm you followed us.</p>
                <input type="text" id="verificationCode" class="modal-input" placeholder="Enter verification code">
                <div class="modal-actions">
                    <button class="modal-btn cancel" id="cancelVerification">Cancel</button>
                    <button class="modal-btn submit" id="submitVerification">Submit</button>
                </div>
            </div>
        </div>

        <!-- App Connect Modal (hidden by default) -->
        <div id="appConnectModal" class="app-connect-modal" style="display: none;">
            <div class="app-connect-content">
                <div class="app-connect-icon" id="appConnectIcon"></div>
                <h3 id="appConnectTitle">Connect to App</h3>
                <p id="appConnectMessage">Please open the app and click 'Connect' to activate your mining boost.</p>
                <button class="task-btn" id="appConnectCheckBtn" style="margin-top: 1.5rem;">
                    <i class="fas fa-sync-alt"></i> Check Connection
                </button>
                <button class="modal-btn cancel" id="appConnectCancelBtn" style="margin-top: 1rem;">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <script>
        // User Authentication System
        const authModal = document.getElementById('authModal');
        const loginTab = document.getElementById('loginTab');
        const signupTab = document.getElementById('signupTab');
        const loginForm = document.getElementById('loginForm');
        const signupForm = document.getElementById('signupForm');
        const loginEmail = document.getElementById('loginEmail');
        const loginPassword = document.getElementById('loginPassword');
        const loginBtn = document.getElementById('loginBtn');
        const loginError = document.getElementById('loginError');
        const signupName = document.getElementById('signupName');
        const signupEmail = document.getElementById('signupEmail');
        const signupPassword = document.getElementById('signupPassword');
        const signupConfirmPassword = document.getElementById('signupConfirmPassword');
        const signupBtn = document.getElementById('signupBtn');
        const signupError = document.getElementById('signupError');
        const forgotPassword = document.getElementById('forgotPassword');
        const appContent = document.getElementById('appContent');
        const logoutBtn = document.getElementById('logoutBtn');
        const userName = document.getElementById('userName');
        const userAvatar = document.getElementById('userAvatar');
        const adminDashboard = document.getElementById('adminDashboard');

        // Admin credentials (in a real app, this would be server-side)
        const ADMIN_EMAIL = "admin@dub.com";
        const ADMIN_PASSWORD = "DUBadmin123!";

        // User database simulation (in a real app, this would be server-side)
        let usersDatabase = {
            [ADMIN_EMAIL]: {
                name: "Admin",
                password: ADMIN_PASSWORD,
                isAdmin: true,
                userId: "admin_001",
                earnings: 0,
                bandwidthShared: 0,
                lastActive: null,
                referralCode: "DUB-ADMIN-001",
                referrals: []
            }
        };

        // Current user session
        let currentUser = null;

        // Switch between login and signup tabs
        loginTab.addEventListener('click', function() {
            loginTab.classList.add('active');
            signupTab.classList.remove('active');
            loginForm.classList.add('active');
            signupForm.classList.remove('active');
            loginError.style.display = 'none';
        });

        signupTab.addEventListener('click', function() {
            signupTab.classList.add('active');
            loginTab.classList.remove('active');
            signupForm.classList.add('active');
            loginForm.classList.remove('active');
            signupError.style.display = 'none';
        });

        // Login function
        loginBtn.addEventListener('click', function() {
            const email = loginEmail.value.trim();
            const password = loginPassword.value;
            
            if (!email || !password) {
                loginError.textContent = "Please enter both email and password";
                loginError.style.display = 'block';
                return;
            }
            
            // Check if user exists and password matches
            if (usersDatabase[email] && usersDatabase[email].password === password) {
                // Successful login
                currentUser = {
                    email: email,
                    name: usersDatabase[email].name,
                    isAdmin: usersDatabase[email].isAdmin || false,
                    userId: usersDatabase[email].userId,
                    referralCode: usersDatabase[email].referralCode
                };
                
                // Update last active time
                usersDatabase[email].lastActive = new Date().toISOString();
                
                // Hide auth modal and show app content
                authModal.style.display = 'none';
                appContent.style.display = 'block';
                
                // Update UI with user info
                userName.textContent = currentUser.name;
                userAvatar.textContent = currentUser.name.charAt(0).toUpperCase();
                
                // Generate random color for avatar
                const colors = ['#00ffaa', '#0088ff', '#ff00aa', '#aa00ff', '#ffaa00'];
                const randomColor = colors[Math.floor(Math.random() * colors.length)];
                userAvatar.style.background = randomColor;
                
                // If admin, show admin dashboard
                if (currentUser.isAdmin) {
                    adminDashboard.style.display = 'block';
                    updateAdminDashboard();
                }
                
                // Initialize user data
                initializeUserData();
            } else {
                loginError.textContent = "Invalid email or password";
                loginError.style.display = 'block';
            }
        });

        // Signup function
        signupBtn.addEventListener('click', function() {
            const name = signupName.value.trim();
            const email = signupEmail.value.trim();
            const password = signupPassword.value;
            const confirmPassword = signupConfirmPassword.value;
            
            // Validate inputs
            if (!name || !email || !password || !confirmPassword) {
                signupError.textContent = "Please fill in all fields";
                signupError.style.display = 'block';
                return;
            }
            
            if (password !== confirmPassword) {
                signupError.textContent = "Passwords don't match";
                signupError.style.display = 'block';
                return;
            }
            
            if (password.length < 8) {
                signupError.textContent = "Password must be at least 8 characters";
                signupError.style.display = 'block';
                return;
            }
            
            // Check if email already exists
            if (usersDatabase[email]) {
                signupError.textContent = "Email already registered";
                signupError.style.display = 'block';
                return;
            }
            
            // Create new user
            const userId = 'user_' + Math.random().toString(36).substr(2, 9);
            const referralCode = 'DUB-' + Math.random().toString(36).substr(2, 4).toUpperCase() + '-' + 
                                 Math.random().toString(36).substr(2, 4).toUpperCase();
            
            usersDatabase[email] = {
                name: name,
                password: password,
                isAdmin: false,
                userId: userId,
                earnings: 0,
                bandwidthShared: 0,
                lastActive: null,
                referralCode: referralCode,
                referrals: [],
                earningsHistory: new Array(7).fill(0),
                dailyGoal: 0
            };
            
            // Auto-login the new user
            currentUser = {
                email: email,
                name: name,
                isAdmin: false,
                userId: userId,
                referralCode: referralCode
            };
            
            // Hide auth modal and show app content
            authModal.style.display = 'none';
            appContent.style.display = 'block';
            
            // Update UI with user info
            userName.textContent = currentUser.name;
            userAvatar.textContent = currentUser.name.charAt(0).toUpperCase();
            
            // Generate random color for avatar
            const colors = ['#00ffaa', '#0088ff', '#ff00aa', '#aa00ff', '#ffaa00'];
            const randomColor = colors[Math.floor(Math.random() * colors.length)];
            userAvatar.style.background = randomColor;
            
            // Initialize user data
            initializeUserData();
            
            // Update referral code in UI
            refCode.value = referralCode;
        });

        // Forgot password
        forgotPassword.addEventListener('click', function(e) {
            e.preventDefault();
            alert('Password reset link has been sent to your email (simulated)');
        });

        // Logout function
        logoutBtn.addEventListener('click', function() {
            currentUser = null;
            appContent.style.display = 'none';
            authModal.style.display = 'flex';
            
            // Reset forms
            loginEmail.value = '';
            loginPassword.value = '';
            loginError.style.display = 'none';
            
            // Switch to login tab
            loginTab.classList.add('active');
            signupTab.classList.remove('active');
            loginForm.classList.add('active');
            signupForm.classList.remove('active');
        });

        // Initialize user data when logged in
        function initializeUserData() {
            // Load user data from "database"
            const userData = usersDatabase[currentUser.email];
            
            // Set earnings
            earnings = userData.earnings || 0;
            earningsDisplay.innerHTML = `<B>${earnings.toFixed(2)}<br>$DUB</B>`;
            
            // Set earnings history
            if (userData.earningsHistory) {
                earningsHistory = userData.earningsHistory;
            } else {
                earningsHistory = new Array(7).fill(0);
            }
            
            // Set daily goal
            if (userData.dailyGoal) {
                dailyGoal = userData.dailyGoal;
                dailyGoalInput.value = dailyGoal;
                goalProgress.textContent = `${earnings.toFixed(2)}/${dailyGoal} DUB`;
            }
            
            // Set referral stats
            if (userData.referrals) {
                referralsCount = userData.referrals.length;
                referralEarningsTotal = userData.referrals.reduce((sum, ref) => sum + ref.earnings, 0);
                updateReferralStats();
            }
            
            // Set referral code
            refCode.value = currentUser.referralCode;
            
            // Update UI
            updateGraph();
            updateDate();
        }

        // Update admin dashboard
        function updateAdminDashboard() {
            if (!currentUser || !currentUser.isAdmin) return;
            
            // Calculate admin stats
            const userEmails = Object.keys(usersDatabase);
            const totalUsers = userEmails.length - 1; // Exclude admin
            const activeUsers = userEmails.filter(email => {
                const user = usersDatabase[email];
                return !user.isAdmin && user.lastActive && 
                       (new Date() - new Date(user.lastActive)) < 24 * 60 * 60 * 1000;
            }).length;
            
            const totalBandwidthGB = Object.values(usersDatabase)
                .filter(user => !user.isAdmin)
                .reduce((sum, user) => sum + (user.bandwidthShared || 0), 0) / 1024;
            
            const totalEarnings = Object.values(usersDatabase)
                .filter(user => !user.isAdmin)
                .reduce((sum, user) => sum + (user.earnings || 0), 0);
            
            // Update admin stats
            document.getElementById('adminTotalUsers').textContent = totalUsers;
            document.getElementById('adminActiveUsers').textContent = activeUsers;
            document.getElementById('adminTotalBandwidth').textContent = totalBandwidthGB.toFixed(2);
            document.getElementById('adminTotalEarnings').textContent = totalEarnings.toFixed(2);
            
            // Update user table
            const userTable = document.getElementById('adminUserTable');
            userTable.innerHTML = '';
            
            userEmails.forEach(email => {
                const user = usersDatabase[email];
                if (user.isAdmin) return;
                
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${user.userId}</td>
                    <td>${user.name}</td>
                    <td>${email}</td>
                    <td>${(user.bandwidthShared / 1024).toFixed(2)} GB</td>
                    <td>${user.earnings.toFixed(2)} DUB</td>
                    <td>${user.lastActive ? new Date(user.lastActive).toLocaleString() : 'Never'}</td>
                `;
                
                userTable.appendChild(row);
            });
        }

        // Admin export button
        document.getElementById('adminExportBtn').addEventListener('click', function() {
            // Prepare data for export
            let exportData = [];
            
            for (const [email, user] of Object.entries(usersDatabase)) {
                if (user.isAdmin) continue;
                
                exportData.push({
                    'User ID': user.userId,
                    'Name': user.name,
                    'Email': email,
                    'Bandwidth Shared (GB)': (user.bandwidthShared / 1024).toFixed(2),
                    'Total Earnings (DUB)': user.earnings.toFixed(2),
                    'Referral Code': user.referralCode,
                    'Referrals Count': user.referrals.length,
                    'Referral Earnings': user.referrals.reduce((sum, ref) => sum + ref.earnings, 0).toFixed(2),
                    'Last Active': user.lastActive ? new Date(user.lastActive).toLocaleString() : 'Never'
                });
            }
            
            // Create worksheet
            const ws = XLSX.utils.json_to_sheet(exportData);
            
            // Create workbook
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "UserData");
            
            // Generate Excel file
            const fileName = `DUB_User_Data_${new Date().toISOString().slice(0,10)}.xlsx`;
            XLSX.writeFile(wb, fileName);
        });

        // Mining Simulation
        const mineBtn = document.getElementById('mineBtn');
        const miningStatus = document.getElementById('miningStatus');
        const connectionStatus = document.getElementById('connectionStatus');
        const earningsDisplay = document.getElementById('earningsDisplay');
        const twitterTaskBtn = document.getElementById('twitterTaskBtn');
        const telegramTaskBtn = document.getElementById('telegramTaskBtn');
        const verificationModal = document.getElementById('verificationModal');
        const verificationCodeInput = document.getElementById('verificationCode');
        const cancelVerification = document.getElementById('cancelVerification');
        const submitVerification = document.getElementById('submitVerification');
        const currentDateElement = document.getElementById('currentDate');
        const extensionBtn = document.getElementById('extensionBtn');
        const telegramBtn = document.getElementById('telegramBtn');
        const desktopBtn = document.getElementById('desktopBtn');
        const graphSvg = document.getElementById('graphSvg');
        const xAxisDates = document.getElementById('xAxisDates');
        const adminPanel = document.getElementById('adminPanel');
        const exportDataBtn = document.getElementById('exportDataBtn');
        const totalBandwidthElement = document.getElementById('totalBandwidth');
        const activeSessionsElement = document.getElementById('activeSessions');

        // Goal system elements
        const dailyGoalInput = document.getElementById('dailyGoal');
        const setGoalBtn = document.getElementById('setGoalBtn');
        const goalProgress = document.getElementById('goalProgress');
        const goalReachedMessage = document.getElementById('goalReached');

        // App connect modal elements
        const appConnectModal = document.getElementById('appConnectModal');
        const appConnectIcon = document.getElementById('appConnectIcon');
        const appConnectTitle = document.getElementById('appConnectTitle');
        const appConnectMessage = document.getElementById('appConnectMessage');
        const appConnectCheckBtn = document.getElementById('appConnectCheckBtn');
        const appConnectCancelBtn = document.getElementById('appConnectCancelBtn');

        // Referral elements
        const totalReferrals = document.getElementById('totalReferrals');
        const referralEarnings = document.getElementById('referralEarnings');
        const refCode = document.getElementById('refCode');

        let isMining = false;
        let isConnecting = false;
        let miningInterval;
        const correctVerificationCode = '999';
        let lastUpdateTime = Date.now();
        let miningMultiplier = 1;
        let bandwidthSpeed = 10; // Simulated bandwidth speed (Mbps)
        let activeBoosts = {
            extension: false,
            telegram: false,
            desktop: false
        };

        // Server Simulation (in-memory)
        const server = {
            bandwidthData: [],
            totalBandwidth: 0,
            activeSessions: 0,
            users: {},
            
            // Simulate sending data to server
            receiveData: function(userId, data) {
                if (!this.users[userId]) {
                    this.users[userId] = {
                        bandwidthData: [],
                        totalBandwidth: 0
                    };
                }
                
                this.users[userId].bandwidthData.push(data);
                this.users[userId].totalBandwidth += data.bandwidthMB;
                this.totalBandwidth += data.bandwidthMB;
                
                // Update admin panel
                totalBandwidthElement.textContent = this.totalBandwidth.toFixed(2);
            },
            
            // Simulate starting a session
            startSession: function(userId) {
                this.activeSessions++;
                activeSessionsElement.textContent = this.activeSessions;
            },
            
            // Simulate ending a session
            endSession: function(userId) {
                this.activeSessions--;
                activeSessionsElement.textContent = this.activeSessions;
            },
            
            // Export all data to Excel
            exportAllData: function() {
                if (Object.keys(this.users).length === 0) {
                    alert('No data to export yet!');
                    return;
                }
                
                // Prepare data for export
                let exportData = [];
                
                for (const [userId, userData] of Object.entries(this.users)) {
                    userData.bandwidthData.forEach(record => {
                        exportData.push({
                            'User ID': userId,
                            'Timestamp': record.timestamp,
                            'Speed (Mbps)': record.speedMbps,
                            'Duration (s)': record.durationSeconds,
                            'Bandwidth (MB)': record.bandwidthMB
                        });
                    });
                }
                
                // Create worksheet
                const ws = XLSX.utils.json_to_sheet(exportData);
                
                // Create workbook
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, "BandwidthData");
                
                // Generate Excel file
                const fileName = `DUB_Bandwidth_Data_${new Date().toISOString().slice(0,10)}.xlsx`;
                XLSX.writeFile(wb, fileName);
            }
        };

        // Bandwidth data collection
        let bandwidthData = [];
        let sessionStartTime = null;
        let totalBandwidthShared = 0;

        // Track which apps are downloaded but not connected
        let downloadedApps = {
            extension: false,
            telegram: false,
            desktop: false
        };

        // Referral stats
        let referralEarningsTotal = 0;
        let referralsCount = 0;

        // Goal system variables
        let dailyGoal = 0;
        let goalReached = false;

        // Initialize with current date as start date
        const startDate = new Date();
        
        // Generate labels for the last 7 days starting from today
        const dateLabels = [];
        for (let i = 0; i < 7; i++) {
            const date = new Date(startDate);
            date.setDate(date.getDate() - (6 - i)); // Creates dates from 6 days ago to today
            dateLabels.push(date);
        }

        // Initialize earnings history with zeros
        let earningsHistory = new Array(7).fill(0);

        // Function to record bandwidth usage and send to server
        function recordBandwidthUsage(speed, duration) {
            const timestamp = new Date();
            const dataPoint = {
                timestamp: timestamp.toISOString(),
                speedMbps: speed,
                durationSeconds: duration,
                bandwidthMB: (speed * duration) / 8 // Convert Mbps to MB
            };
            
            // Send to simulated server
            server.receiveData(currentUser.userId, dataPoint);
            
            // Store locally for this session
            bandwidthData.push(dataPoint);
            totalBandwidthShared += dataPoint.bandwidthMB;
            
            // Update user's total bandwidth in database
            if (usersDatabase[currentUser.email]) {
                usersDatabase[currentUser.email].bandwidthShared = 
                    (usersDatabase[currentUser.email].bandwidthShared || 0) + dataPoint.bandwidthMB;
            }
            
            // Update admin dashboard if visible
            if (currentUser && currentUser.isAdmin && adminDashboard.style.display === 'block') {
                updateAdminDashboard();
            }
        }

        // Update graph with current earnings data
        function updateGraph() {
            // Clear previous bars (keep the baseline)
            const bars = graphSvg.querySelectorAll('.graph-bar, text');
            bars.forEach(bar => bar.remove());
            
            // Fixed max value at 10k
            const maxValue = 10000;
            
            // Create bars for each day
            const barWidth = 40;
            const gap = (500 - (7 * barWidth)) / 6;
            
            dateLabels.forEach((date, index) => {
                const value = earningsHistory[index] || 0;
                const barHeight = (value / maxValue) * 250; // Full height at 10k
                const xPos = index * (barWidth + gap);
                
                // Create bar
                const bar = document.createElementNS("http://www.w3.org/2000/svg", "rect");
                bar.setAttribute("x", xPos);
                bar.setAttribute("y", 250 - barHeight);
                bar.setAttribute("width", barWidth);
                bar.setAttribute("height", barHeight);
                bar.setAttribute("class", "graph-bar");
                bar.setAttribute("data-value", value.toFixed(2));
                graphSvg.appendChild(bar);
                
                // Add value label if not zero
                if (value > 0) {
                    const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
                    text.setAttribute("x", xPos + barWidth/2);
                    text.setAttribute("y", 240 - barHeight);
                    text.setAttribute("text-anchor", "middle");
                    text.setAttribute("font-size", "10");
                    text.setAttribute("fill", "white");
                    text.textContent = value.toFixed(2);
                    graphSvg.appendChild(text);
                }
            });
            
            // Update x-axis dates
            xAxisDates.innerHTML = '';
            dateLabels.forEach((date, index) => {
                const dateElement = document.createElement("span");
                dateElement.textContent = date.toLocaleDateString(undefined, { month: 'short', day: 'numeric' });
                xAxisDates.appendChild(dateElement);
            });
        }

        // Check if goal is reached
        function checkGoal() {
            if (dailyGoal > 0 && earnings >= dailyGoal && !goalReached) {
                goalReached = true;
                goalReachedMessage.style.display = 'block';
                setTimeout(() => {
                    goalReachedMessage.style.display = 'none';
                }, 5000);
            }
            goalProgress.textContent = `${earnings.toFixed(2)}/${dailyGoal} DUB`;
        }

        // Update date display
        function updateDate() {
            const now = new Date();
            currentDateElement.textContent = now.toLocaleDateString() + ' ' + now.toLocaleTimeString();
        }

        // Calculate mining speed based on boosts and bandwidth
        function calculateMiningSpeed() {
            let speed = 0.1; // Base speed
            speed *= miningMultiplier;
            
            // Apply boosts only if they're both downloaded AND connected
            if (activeBoosts.extension) speed *= 3;
            if (activeBoosts.telegram) speed *= 1.5;
            if (activeBoosts.desktop) speed *= 5;
            
            // Apply bandwidth factor (simulated)
            speed *= (bandwidthSpeed / 10);
            
            return speed;
        }

        // Simulate collecting user data
        function collectUserData() {
            // In a real implementation, this would collect various data points
            const dataPoints = [
                'Browser: ' + navigator.userAgent,
                'IP: 192.168.1.1', // Simulated
                'Location: ' + Intl.DateTimeFormat().resolvedOptions().timeZone,
                'Device: ' + (window.innerWidth > 768 ? 'Desktop' : 'Mobile'),
                'Bandwidth: ' + bandwidthSpeed + 'Mbps',
                'Active at: ' + new Date().toISOString()
            ];
            
            console.log('Collected user data:', dataPoints);
            // In a real app, this would be sent to your server
        }

        // Show app connect modal
        function showAppConnectModal(app) {
            let icon, title, message;
            
            switch(app) {
                case 'extension':
                    icon = '<i class="fab fa-chrome"></i>';
                    title = 'Connect Browser Extension';
                    message = 'Please open the DUB extension and click "Connect" to activate your 3x mining boost.';
                    break;
                case 'telegram':
                    icon = '<i class="fab fa-telegram"></i>';
                    title = 'Connect Telegram Bot';
                    message = 'Please open the DUB Telegram bot and click "Connect" to activate your 1.5x mining boost.';
                    break;
                case 'desktop':
                    icon = '<i class="fas fa-desktop"></i>';
                    title = 'Connect Desktop App';
                    message = 'Please open the DUB Desktop app and click "Connect" to activate your 5x mining boost.';
                    break;
            }
            
            appConnectIcon.innerHTML = icon;
            appConnectTitle.textContent = title;
            appConnectMessage.textContent = message;
            appConnectModal.style.display = 'flex';
            
            // Set up check button handler
            appConnectCheckBtn.onclick = function() {
                // Simulate checking connection (in a real app, this would ping the app)
                if (Math.random() > 0.3) { // 70% chance of success for demo
                    activeBoosts[app] = true;
                    appConnectModal.style.display = 'none';
                    
                    // Update the button in the UI
                    const btn = document.getElementById(`${app}Btn`);
                    btn.innerHTML = '<i class="fas fa-check"></i> Connected';
                    btn.classList.add('connected');
                    
                    alert(`${title.split(' ')[2]} connected! Mining speed increased.`);
                    
                    if (isMining) {
                        connectionStatus.textContent = 'Mining at ' + bandwidthSpeed + 'Mbps (' + (calculateMiningSpeed() * 100).toFixed(0) + '% speed)';
                    }
                } else {
                    alert('Connection not detected. Please make sure you clicked "Connect" in the app.');
                }
            };
        }

        // Update referral stats
        function updateReferralStats() {
            referralEarnings.textContent = referralEarningsTotal.toFixed(2);
            totalReferrals.textContent = referralsCount;
            
            // Update in user database
            if (currentUser && usersDatabase[currentUser.email]) {
                usersDatabase[currentUser.email].referrals = usersDatabase[currentUser.email].referrals || [];
                usersDatabase[currentUser.email].referrals.push({
                    userId: 'ref_' + Math.random().toString(36).substr(2, 6),
                    earnings: referralEarningsTotal,
                    date: new Date().toISOString()
                });
            }
        }

        // Initialize
        updateDate();
        updateGraph();
        updateReferralStats();
        setInterval(updateDate, 1000);

        // Set up admin panel (for demo purposes - would be secured in production)
        if (window.location.hash === '#admin') {
            adminPanel.style.display = 'block';
        }

        // Set up export button
        exportDataBtn.addEventListener('click', function() {
            server.exportAllData();
        });

        // Set Goal Button
        setGoalBtn.addEventListener('click', function() {
            const goalValue = parseInt(dailyGoalInput.value);
            if (goalValue > 0) {
                dailyGoal = goalValue;
                goalReached = false;
                goalProgress.textContent = `${earnings.toFixed(2)}/${dailyGoal} DUB`;
                alert(`Daily goal set to ${dailyGoal} DUB!`);
                
                // Save goal to user database
                if (currentUser && usersDatabase[currentUser.email]) {
                    usersDatabase[currentUser.email].dailyGoal = dailyGoal;
                }
            } else {
                alert('Please enter a valid goal amount');
            }
        });

        // Mining Button
        mineBtn.addEventListener('click', function() {
            if (isConnecting) return;
            
            if (!isMining) {
                // Start connecting sequence
                isConnecting = true;
                mineBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> CONNECTING';
                mineBtn.classList.add('connecting');
                connectionStatus.textContent = 'Establishing connection...';
                
                // Start new session
                sessionStartTime = new Date();
                bandwidthData = [];
                totalBandwidthShared = 0;
                server.startSession(currentUser.userId);
                
                // Update last active time in user database
                if (currentUser && usersDatabase[currentUser.email]) {
                    usersDatabase[currentUser.email].lastActive = new Date().toISOString();
                }
                
                // Simulate connection process
                setTimeout(function() {
                    connectionStatus.textContent = 'Analyzing network...';
                    collectUserData(); // Collect data during connection
                }, 1500);
                
                setTimeout(function() {
                    connectionStatus.textContent = 'Optimizing bandwidth...';
                }, 3000);
                
                setTimeout(function() {
                    isConnecting = false;
                    isMining = true;
                    mineBtn.innerHTML = '<i class="fas fa-power-off"></i> DISCONNECT';
                    mineBtn.classList.remove('connecting');
                    mineBtn.classList.add('active');
                    miningStatus.innerHTML = '<i class="fas fa-circle" style="color: #00ff55;"></i> Status: CONNECTED';
                    connectionStatus.textContent = 'Mining at ' + bandwidthSpeed + 'Mbps (' + (calculateMiningSpeed() * 100).toFixed(0) + '% speed)';
                    
                    // Start mining and data collection
                    let lastRecordTime = Date.now();
                    miningInterval = setInterval(function() {
                        const now = Date.now();
                        const duration = (now - lastRecordTime) / 1000; // in seconds
                        lastRecordTime = now;
                        
                        // Record bandwidth usage
                        recordBandwidthUsage(bandwidthSpeed, duration);
                        
                        // Mining rewards calculation
                        const minedAmount = calculateMiningSpeed() * Math.random();
                        earnings += minedAmount;
                        earningsDisplay.innerHTML = `<B>${earnings.toFixed(2)}<br>$DUB</B>`;
                        
                        // Update in user database
                        if (currentUser && usersDatabase[currentUser.email]) {
                            usersDatabase[currentUser.email].earnings = earnings;
                            
                            // Update today's earnings in history
                            const todayIndex = 6; // Last index is today
                            earningsHistory[todayIndex] = earnings;
                            usersDatabase[currentUser.email].earningsHistory = earningsHistory;
                        }
                        
                        updateGraph();
                        checkGoal(); // Check if goal is reached
                        
                        // Only generate referral earnings if there are referrals
                        if (referralsCount > 0 && Math.random() > 0.9) {
                            referralEarningsTotal += minedAmount * 0.1;
                            updateReferralStats();
                        }
                        
                        // Update admin dashboard if visible
                        if (currentUser && currentUser.isAdmin && adminDashboard.style.display === 'block') {
                            updateAdminDashboard();
                        }
                    }, 1000);
                }, 4500);
            } else {
                // Disconnect immediately
                isMining = false;
                clearInterval(miningInterval);
                mineBtn.innerHTML = '<i class="fas fa-power-off"></i> CONNECT';
                mineBtn.classList.remove('active');
                miningStatus.innerHTML = '<i class="fas fa-circle" style="color: #ff5555;"></i> Status: OFFLINE';
                connectionStatus.textContent = '';
                
                // Record final bandwidth usage
                if (sessionStartTime) {
                    const duration = (new Date() - sessionStartTime) / 1000;
                    recordBandwidthUsage(bandwidthSpeed, duration);
                    sessionStartTime = null;
                    server.endSession(currentUser.userId);
                }
                
                updateGraph();
            }
        });

        // Copy Referral
        function copyReferral() {
            refCode.select();
            document.execCommand('copy');
            alert('Referral link copied!');
        }

        // Boost Buttons - Now show "Coming Soon"
        extensionBtn.addEventListener('click', function(e) {
            e.preventDefault();
            alert('DUB Chrome Extension - Coming Soon!');
        });

        telegramBtn.addEventListener('click', function(e) {
            e.preventDefault();
            alert('DUB Telegram Bot - Coming Soon!');
        });

        desktopBtn.addEventListener('click', function(e) {
            e.preventDefault();
            alert('DUB Desktop App - Coming Soon!');
        });

        // Twitter Task Button
        twitterTaskBtn.addEventListener('click', function() {
            window.open('https://x.com/DUBCOIN9', '_blank');
            verificationModal.style.display = 'flex';
            verificationCodeInput.value = '';
        });

        // Telegram Task Button
        telegramTaskBtn.addEventListener('click', function() {
            window.open('https://t.me/DUBCOIN9', '_blank');
            setTimeout(function() {
                earnings += 2000;
                
                // Update in user database
                if (currentUser && usersDatabase[currentUser.email]) {
                    usersDatabase[currentUser.email].earnings = earnings;
                    
                    // Update today's earnings in history
                    const todayIndex = 6; // Last index is today
                    earningsHistory[todayIndex] = earnings;
                    usersDatabase[currentUser.email].earningsHistory = earningsHistory;
                }
                
                earningsDisplay.innerHTML = `<B>${earnings.toFixed(2)}<br>$DUB</B>`;
                this.textContent = 'Claimed';
                this.disabled = true;
                updateGraph();
                checkGoal();
                alert('Telegram task completed! 2000 DUB has been added to your balance.');
            }.bind(this), 2000);
        });

        // Cancel Verification
        cancelVerification.addEventListener('click', function() {
            verificationModal.style.display = 'none';
        });

        // Submit Verification
        submitVerification.addEventListener('click', function() {
            const userCode = verificationCodeInput.value.trim();
            
            if (userCode === correctVerificationCode) {
                earnings += 3000;
                
                // Update in user database
                if (currentUser && usersDatabase[currentUser.email]) {
                    usersDatabase[currentUser.email].earnings = earnings;
                    
                    // Update today's earnings in history
                    const todayIndex = 6; // Last index is today
                    earningsHistory[todayIndex] = earnings;
                    usersDatabase[currentUser.email].earningsHistory = earningsHistory;
                }
                
                earningsDisplay.innerHTML = `<B>${earnings.toFixed(2)}<br>$DUB</B>`;
                
                twitterTaskBtn.textContent = 'Claimed';
                twitterTaskBtn.disabled = true;
                
                verificationModal.style.display = 'none';
                updateGraph();
                checkGoal();
                
                alert('Verification successful! 3000 DUB has been added to your balance.');
            } else {
                alert('Incorrect verification code. Please check the code and try again.');
            }
        });

        // App Connect Modal Cancel Button
        appConnectCancelBtn.addEventListener('click', function() {
            appConnectModal.style.display = 'none';
        });

        // Simulate network speed detection
        setTimeout(function() {
            // Random bandwidth between 5-100 Mbps for simulation
            bandwidthSpeed = Math.floor(Math.random() * 95) + 5;
            if (isMining) {
                connectionStatus.textContent = 'Mining at ' + bandwidthSpeed + 'Mbps (' + (calculateMiningSpeed() * 100).toFixed(0) + '% speed)';
            }
        }, 10000);

        // Simulate a referral (for demo purposes)
        setTimeout(function() {
            if (Math.random() > 0.7) {
                referralsCount++;
                referralEarningsTotal += (Math.random() * 10).toFixed(2);
                updateReferralStats();
            }
        }, 8000);
    </script>
</body>
</html>